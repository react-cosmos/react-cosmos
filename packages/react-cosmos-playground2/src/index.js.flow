// @flow

import type { SetState } from 'react-cosmos-shared2/util';
import type { FixtureState } from 'react-cosmos-shared2/fixtureState';
import type {
  RendererId,
  FixtureNames,
  RendererRequest,
  RendererResponse
} from 'react-cosmos-shared2/renderer';

export type PlaygroundOptions = {
  rendererUrl: string
};

export type UiState = {
  renderers: RendererId[],
  fixtures: FixtureNames
};

export type ReplaceFixtureState = (FixtureState, cb?: () => mixed) => mixed;

export type RendererRequestListener = RendererRequest => mixed;
export type RendererResponseListener = RendererResponse => mixed;

export type UrlParams = {
  fixture?: string,
  fullscreen?: boolean
};
export type SetUrlParams = ($Shape<UrlParams>) => mixed;

// TODO: Add remaining context fields
// export type PluginState = { [prop: string]: mixed };
// export type SetPluginState = ($Shape<PluginState>) => mixed;

export type PlaygroundContextValue = {
  options: PlaygroundOptions,
  urlParams: UrlParams,
  setUrlParams: SetState<UrlParams>,
  uiState: UiState,
  setUiState: SetState<UiState>,
  fixtureState: ?FixtureState,
  replaceFixtureState: ReplaceFixtureState,
  postRendererRequest: RendererRequest => mixed,
  onRendererRequest: RendererRequestListener => () => mixed, // returns unsubscribe function
  receiveRendererResponse: RendererResponse => mixed,
  onRendererResponse: RendererResponseListener => () => mixed // returns unsubscribe function
};
